"use strict";(self.webpackChunkclient_service=self.webpackChunkclient_service||[]).push([[756],{4756:(e,t,r)=>{r.r(t),r.d(t,{default:()=>M});var n=r(5043),a=r(4516),o=r(4496),s=r(2110),i=r(6494),d=r(7811),c=r(2143),l=r(1906),u=r(1637),p=r(4194),f=r(6734),m=r(579);const y=(0,f.A)((0,m.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send"),h=(0,f.A)((0,m.jsx)("path",{d:"m19 8-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4z"}),"Cached");var v,A=r(7800),g=new Uint8Array(16);function x(){if(!v&&!(v="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return v(g)}const b=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const S=function(e){return"string"===typeof e&&b.test(e)};for(var C=[],I=0;I<256;++I)C.push((I+256).toString(16).substr(1));const j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(C[e[t+0]]+C[e[t+1]]+C[e[t+2]]+C[e[t+3]]+"-"+C[e[t+4]]+C[e[t+5]]+"-"+C[e[t+6]]+C[e[t+7]]+"-"+C[e[t+8]]+C[e[t+9]]+"-"+C[e[t+10]]+C[e[t+11]]+C[e[t+12]]+C[e[t+13]]+C[e[t+14]]+C[e[t+15]]).toLowerCase();if(!S(r))throw TypeError("Stringified UUID is invalid");return r};const T=function(e,t,r){var n=(e=e||{}).random||(e.rng||x)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var a=0;a<16;++a)t[r+a]=n[a];return t}return j(n)},M=()=>{const{idempotencyKey:e,rotateKey:t}=(()=>{const[e,t]=(0,n.useState)(T());return{idempotencyKey:e,rotateKey:(0,n.useCallback)((()=>{t(T())}),[])}})(),[r,f]=(0,n.useState)([]),[v,g]=(0,n.useState)(""),[x,b]=(0,n.useState)(""),[S,C]=(0,n.useState)(""),[I,j]=(0,n.useState)(""),[M,N]=(0,n.useState)("IDLE"),[R,w]=(0,n.useState)(null),[E,U]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{var e;const t=null===(e=JSON.parse(localStorage.getItem("userDetails")||"[]")[0])||void 0===e?void 0:e.userId,r=await A.A.get(`/account/getall?userId=${t}`),n=(Array.isArray(r.data)?r.data:[r.data]).filter((e=>"ACTIVE"===e.status));f(n)}catch(t){w("Failed to load your accounts.")}})()}),[]);const D=async r=>{if(r.preventDefault(),"SUBMITTING"!==M&&"PENDING"!==M){N("SUBMITTING"),w(null);try{await A.A.post("/transaction/transfer",null,{params:{receiverAmount:S,receiverAccountNumber:x},idempotencyKey:e});N("COMPLETED"),w("Transaction successfully initiated! Funds are being moved."),t()}catch(s){var n,a,o;if(409===(null===(n=s.response)||void 0===n?void 0:n.status))N("DUPLICATE"),w("This transaction was already processed. Here is the previous result."),U(s.response.data);else N("FAILED"),w((null===(a=s.response)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.message)||"Transfer failed. You can safely retry this specific transaction.")}}};return(0,m.jsxs)(a.A,{p:3,maxWidth:600,mx:"auto",children:[(0,m.jsx)(o.A,{variant:"h4",fontWeight:"bold",color:"primary",gutterBottom:!0,children:"Transfer Money"}),(0,m.jsx)(o.A,{variant:"body2",color:"textSecondary",mb:4,children:"Securely send funds using banking-grade idempotency keys."}),(0,m.jsx)(s.A,{sx:{borderRadius:4,boxShadow:6},children:(0,m.jsxs)(i.A,{children:[(0,m.jsxs)("form",{onSubmit:D,children:[(0,m.jsx)(d.A,{select:!0,fullWidth:!0,label:"From Account",value:v,onChange:e=>g(e.target.value),margin:"normal",required:!0,disabled:"SUBMITTING"===M,children:r.map((e=>(0,m.jsxs)(c.A,{value:e.id,children:[e.accountType," - XXXX-",e.accountNumber.slice(-4)," (\u20b9",e.balance,")"]},e.id)))}),(0,m.jsx)(d.A,{fullWidth:!0,label:"Recipient Account Number",variant:"outlined",margin:"normal",value:x,onChange:e=>b(e.target.value),required:!0,disabled:"SUBMITTING"===M}),(0,m.jsx)(d.A,{fullWidth:!0,label:"Amount (\u20b9)",type:"number",variant:"outlined",margin:"normal",value:S,onChange:e=>C(e.target.value),required:!0,inputProps:{min:"1",step:"0.01"},disabled:"SUBMITTING"===M}),(0,m.jsx)(a.A,{mt:4,children:(0,m.jsx)(l.A,{type:"submit",variant:"contained",fullWidth:!0,size:"large",startIcon:"SUBMITTING"===M?(0,m.jsx)(u.A,{size:20,color:"inherit"}):(0,m.jsx)(y,{}),disabled:"SUBMITTING"===M||!v||!x||!S,sx:{py:1.5,borderRadius:2},children:"SUBMITTING"===M?"Processing...":"Schedule Transfer"})})]}),R&&(0,m.jsx)(a.A,{mt:3,children:(0,m.jsx)(p.A,{severity:"COMPLETED"===M?"success":"FAILED"===M?"error":"warning",action:"FAILED"===M&&(0,m.jsx)(l.A,{color:"inherit",size:"small",onClick:D,startIcon:(0,m.jsx)(h,{}),children:"RETRY"}),children:R})}),"DUPLICATE"===M&&E&&(0,m.jsxs)(a.A,{mt:2,p:2,bgcolor:"#fffde7",borderRadius:2,border:"1px dashed #fbc02d",children:[(0,m.jsx)(o.A,{variant:"caption",display:"block",color:"warning.dark",children:"PREVIOUS RESULT"}),(0,m.jsx)(o.A,{variant:"body2",children:JSON.stringify(E)})]})]})}),(0,m.jsx)(a.A,{mt:4,textAlign:"center",children:(0,m.jsxs)(o.A,{variant:"caption",color:"textSecondary",display:"flex",alignItems:"center",justifyContent:"center",gap:1,children:[(0,m.jsx)("span",{children:"Idempotency Key:"})," ",(0,m.jsx)("span",{children:e})]})})]})}},6494:(e,t,r)=>{r.d(t,{A:()=>f});var n=r(5043),a=r(8387),o=r(8610),s=r(4535),i=r(8206),d=r(2532),c=r(2372);function l(e){return(0,c.Ay)("MuiCardContent",e)}(0,d.A)("MuiCardContent",["root"]);var u=r(579);const p=(0,s.Ay)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:16,"&:last-child":{paddingBottom:24}}),f=n.forwardRef((function(e,t){const r=(0,i.b)({props:e,name:"MuiCardContent"}),{className:n,component:s="div",...d}=r,c={...r,component:s},f=(e=>{const{classes:t}=e;return(0,o.A)({root:["root"]},l,t)})(c);return(0,u.jsx)(p,{as:s,className:(0,a.A)(f.root,n),ownerState:c,ref:t,...d})}))},2110:(e,t,r)=>{r.d(t,{A:()=>m});var n=r(5043),a=r(8387),o=r(8610),s=r(4535),i=r(8206),d=r(1596),c=r(2532),l=r(2372);function u(e){return(0,l.Ay)("MuiCard",e)}(0,c.A)("MuiCard",["root"]);var p=r(579);const f=(0,s.Ay)(d.A,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})({overflow:"hidden"}),m=n.forwardRef((function(e,t){const r=(0,i.b)({props:e,name:"MuiCard"}),{className:n,raised:s=!1,...d}=r,c={...r,raised:s},l=(e=>{const{classes:t}=e;return(0,o.A)({root:["root"]},u,t)})(c);return(0,p.jsx)(f,{className:(0,a.A)(l.root,n),elevation:s?8:void 0,ref:t,ownerState:c,...d})}))}}]);
//# sourceMappingURL=756.eabc55bb.chunk.js.map